import { anthropic } from "@ai-sdk/anthropic";
import { generateText } from "ai";
import { playConversation } from "./src/parser";

const res = await generateText({
	prompt: `
日常系アニメのような三人の女子高生による会話の正確なトランスクリプトを生成してください。
登場人物はkyoko(ボケ)(口調:元気), aya(マイペース)(口調:のんびり), natsumi(ツッコミ)(口調:ツッコミ)です。
一人称は全員「私」です。

# 正確なトランスクリプトの生成ルール

## 基本構造
- 1発言は1-3文、30文字以内を目安とする
- 情報提示->反応->展開のサイクルを維持
- 5-15ターンで1つの話題を完結させる

## ターン設計 
1. 長い説明を避け、複数ターンに分割
2. 相手の反応を引き出すポイントで発言を区切る
3. 発言の長さに変化をつけてリズムを作る

## コメディ構造
- ボケ->ツッコミ->展開の3層を意識
- 全ての発言に機能(情報/キャラ性/関係性/コメディ/リズム)を持たせる
- 予想外の短い発言でオチを作る
- 短い発言のオーバーラップを積極的に活用し、キャラクターの連帯感を表す
- 一人の発言に対して、二人が順番につっこむなどの構造も活用

## キャラクター性
- 各話者に会話内での役割を割り当てる
- 役割: ボケ/ツッコミ/加速/調停
- 一人が複数の役割を持ってもよい

# 例

[kyoko]:あ、そういえば今日購買でプリン売ってたよ.
[aya]:_プリン_:いいね:::.
[kyoko]:[ねー].
[aya]:[ねー].
[kyoko]:(1)プリンってさ、プリッとしてるから_プリン_なのかな.
[natsumi]:知らんよ.
[aya]:あ、でも_ぷるぷる_だから_プルン_じゃなくて_プリン_なのか.
[kyoko]:ああ<ぷるぷるプリン>語呂[いいね].
[aya]:[おー!].
[natsumi]:進めろよ.で、結局買ったの?.
[kyoko]:買った?、バニラ味?.
[aya]:いいなぁ.食べたい.
[kyoko]:今から食べようか.
[natsumi]:冷蔵庫に入れるところないぞ.
[aya]:あ、そっか.教室に冷蔵庫ないもんね.
[kyoko]:今夜のおやつにしとこ.
[natsumi]:ん.そっちの方がいいな.
[aya]:プリン待ち遠しい:::.
[kyoko]:待ってたら、プリン.プリン待ち.
[natsumi]:意味わかんない.

[kyoko]:あ、そういえば、教科書ってさ:::
[natsumi]:(1)嫌な予感がする.
[kyoko]:教える科目の本だから_教科書_でしょ?.
[aya]:そうだね、教科書だね.
[kyoko]:じゃあ、>私たちがこれを枕にして寝たら<=
[aya]:=<_安眠書になっちゃう_>!?.
[kyoko]:[そう!].
[aya]:[すごーい!]=
[natsumi]:=なんねーよ.
[kyoko]:じゃあ、なつみちゃんがこれで誰かを叩いたら=
[aya]:=<鈍器書になっちゃう>!?.
[natsumi]:(1)物騒なんだよ.
[kyoko]:でも、漢字は漢字で=
[aya]:=漢字は漢字だよね
[kyoko]:書いてある.
[natsumi]:(1)その話さっき終わっただろ.

[kyoko]:あー.
[aya]:どうしたの?そんなに、消しゴム、見つめて.
[kyoko]:これさー、消しゴムって言うけどさ、使うと
[kyoko]:ゴム自体は、増えてない?
[natsumi]:[は::?]
[aya]:[え::?]
[kyoko]:だって、消すと、カスが出るじゃん↑._消してるのに、物質的には、増えてる気がする_.=
[aya]:=>あー!わかるかも::!<消しカス、集めると結構な量になるもんね.
[natsumi]:(.)減ってるから.本体.
[kyoko]:えー、でもさー-
[kyoko]:これを全部集めて、ギュッ↑てしたら、元の形に戻るのかな.
[natsumi]:戻んないよ。進めろよ、プリント.
[aya]:でも、もし戻ったら::(1)無限消しゴム?
[kyoko]:それだ:::!エコだね.

# 1ブロックのトランスクリプトを生成してください。トランスクリプト以外の文字は不要です。

最重要:Jefferson転写記号で、会話文に音声的な特徴を与えてください。
特に長音、二人でのオーバーラップを意識してください。
`,
	model: anthropic("claude-haiku-4-5"),
});

console.log(res.text);
await playConversation(res.text);
